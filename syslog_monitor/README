syslog_monitor is a helper script for monitoring systems.  

When it was written (many years ago) plugins didn't exist for Nagios
that allowed me to monitor everything I wanted to.  Fortunately many of
these things generated relevant output to syslog, so by watching syslog
we can generate alerts to Nagios (or whatever).

To use, first add the following to your syslog configuration:

*.*    | exec cat - > /var/log/messages.pipe

and restart syslog.  Configure syslog_monitor to watch whatever you
want, eg:

my %regex = (
	'swap_pager:\sI\/O\serror' 	=> 'swap',
);

and start it up.  You can now interrogate the daemon by connecting to
port 30080 and sending:

swap\n

The daemon will respond with any buffered syslog data matching the
'swap' regular expression.


Included is the nagios plugin check_syslog that utilizes the
syslog_monitor utility.  Deploy it to your nrpe plugin directory and
configure nrpe thus:

command[check_syslog_swap]=/usr/local/libexec/nagios/check_syslog swap

Now whenever a syslog entry is generated by swap_pager showing an I/O
error, it will be buffered by syslog_monitor until nrpe requests a
status update.  Any output from syslog_monitor will generate a Nagio
warning, which you can handle in the usual way.
  
